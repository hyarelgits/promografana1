setenforce 0
Modify /etc/selinux/config and change enforcing to disabled.
Install Prerequisites
We now need to install the programs that Core will need in order to function / install properly.

yum install httpd php php-cli gcc glibc glibc-common gd gd-devel net-snmp openssl-devel wget unzip
-y
Now, let's create a user and group for Nagios to use.

useradd nagios
groupadd nagcmd
usermod -a -G nagcmd nagios
usermod -a -G nagcmd apache
Download and Install Nagios
This is where we will download the required .tar.gz files for Nagios and Nagios Plugins.

cd /tmp
wget https://assets.nagios.com/downloads/nagioscore/releases/nagios-4.1.1.tar.gz
wget http://www.nagios-plugins.org/download/nagios-plugins-2.1.1.tar.gz
tar zxf nagios-4.1.1.tar.gz
tar zxf nagios-plugins-2.1.1.tar.gz

cd nagios-4.1.1
Now that the files are extracted, let's start compiling Nagios!
./configure --with-command-group=nagcmd
make all
make install
make install-init
make install-config
make install-commandmode
make install-webconf


We now need to create a password for the nagiosadmin user. This will be used to login to your core web GUI.
htpasswd -c /usr/local/nagios/etc/htpasswd.users nagiosadmin

Install Nagios Plugins
Now that Nagios is installed, we need to install the plugins so that it can utilize them for checks.
cd /tmp/nagios-plugins-2.1.1
./configure --with-nagios-user=nagios --with-nagios-group=nagios --with-openssl
make all
make install
Start Nagios
If everything worked correctly prior to this, you will be able to start your Nagios Core service.
service httpd start
service nagios start
You should now be able to access your machine by navigating to http://nagiosip/nagios/ - if this does not work then please try these two
troubleshooting steps.
Troubleshooting
If you cannot access the Nagios web page, it may be related to your firewall rules. The following command will open up port 80 on your
Nagios Core machine.
firewall-cmd --zone=public --add-port=80/tcp --permanent
firewall-cmd --reload
If you are still unable to access the web GUI, your web server may be only listening on IPv6. Modify /etc/httpd/conf/httpd.conf
and look for the part that says 'Listen :80'. Modify it to be 'Listen 0.0.0.0:80'. Then, run service httpd restart




Nagios NRPE 


yum install -y gcc glibc glibc-common openssl openssl-devel


wget https://github.com/NagiosEnterprises/nrpe/releases/download/nrpe-4.1.0/nrpe-4.1.0.tar.gz -P /tmp/


cd /tmp
tar zxvf nrpe-4.1.0.tar.gz



cd nrpe-4.1.0
./configure --enable-command-args --with-nrpe-user=nagios --with-nrpe-group=nagios



make install-groups-users


id nagios


make all


make install


make install-config
make install-init



vi /usr/local/nagios/etc/objects/localhost.cfg


vim /usr/local/nagios/etc/nrpe.cfg





  yum install -y gcc glibc glibc-common openssl openssl-devel
    2  wget https://github.com/NagiosEnterprises/nrpe/releases/download/nrpe-4.1.0/nrpe-4.1.0.tar.gz -P /tmp/
    3  tar zxvf nrpe-4.1.0.tar.gz
    4  tar xvf nrpe-4.1.0.tar.gz
    5  ls
    6  cd /tmp
    7  tar zxvf nrpe-4.1.0.tar.gz
    8  cd nrpe-4.1.0
    9  ./configure --enable-command-args --with-nrpe-user=nagios --with-nrpe-group=nagios
   10  make install-groups-users
   11  make all
   12  make install
   13  make install-config
   14  make install-init
   15  firewall-cmd --add-port=5666/tcp --permanent
   16  firewall-cmd --reload
   17  iptables -I INPUT -p tcp --dport 5666 -j ACCEPT
   18  iptables-save > /etc/sysconfig/iptables
   19  systemctl start nrpe
   20  systemctl enable nrpe
   21  vim /usr/local/nagios/etc/nrpe.cfg
   22  systemctl restart nrpe
   23  /usr/local/nagios/libexec/check_nrpe -H 127.0.0.1
   24  /usr/local/nagios/libexec/check_nrpe -H 192.168.11.131
   25  /usr/local/nagios/libexec/check_nrpe -H 127.0.0.1 -c check_total_procs
   26  USERS OK - 2 users currently logged in |users=2;5;10;0
   27  /usr/local/nagios/libexec/check_nrpe -H 127.0.0.1 -c check_users
   28  /usr/local/nagios/libexec/check_nrpe -H 192.168.11.132
   29  setenforce 0
   30  /usr/local/nagios/libexec/check_nrpe -H 192.168.11.132
   31  /usr/local/nagios/libexec/check_nrpe -H 192.168.11.131
   32  command[check_root_disk]=/usr/lib/nagios/plugins/check_disk -w 20% -c 10% -p /
   33  check_nrpe -H 192.168.11.132
   34  check_nrpe -H 192.168.11.131
   35  yum install epel-release -y
   36  check_nrpe -H 192.168.11.132
   37  vi /etc/sysconfig/iptables
   38  service iptables restart
   39  systemctl restart iptables.service
   40  /usr/local/nagios/libexec/check_nrpe -H 127.0.0.1
   41  /usr/local/nagios/libexec/check_nrpe -H 192.168.11.131
   42  ping 192.168.11.131
   43  vim /usr/local/nagios/etc/nrpe.cfg
   44  systemctl restart nrpe
   45  /usr/local/nagios/libexec/check_nrpe -H 192.168.11.131
   46  vim /usr/local/nagios/etc/nrpe.cfg
   47  systemctl restart nrpe
   48  /usr/local/nagios/libexec/check_nrpe -H 192.168.11.131
   49  cd /usr/local/nagios/libexec/
   50  ./check_
   51  ./check_nrpe 
   52  ./check_nrpe -H 192.168.11.131
   53  vim /usr/local/nagios/etc/nrpe.cfg
   54  systemctl restart nrpe
   55  /usr/local/nagios/libexec/check_nrpe -H 192.168.11.131
   56  getenforce
   57  getenforce 1
   58  getenforce
   59  getenforce 0
   60  getenforce
   61  ~]~ getenforce
   62  getenforce
   63  getenforce 0
   64  reboot
   65  getenforce
   66  getenforce 1
   67  reboot
   68  systemctl restart httpd
   69  systemctl restart nagios
   70  vim /usr/local/nagios/etc/nrpe.cfg
   71  history
   72  vi /usr/local/nagios/etc/objects/localhost.cfg 
   73  systemctl restart nagios
   74  vi /usr/local/nagios/etc/objects/localhost.cfg 
   75  systemctl restart nagios
   76  clear
   77  vi /usr/local/nagios/etc/objects/localhost.cfg 
   78  history
[root@localhost ~]# 






